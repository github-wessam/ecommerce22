<p-breadcrumb [home]="home" [model]="items"></p-breadcrumb>
<div *ngIf="product; else loading">
  <div class="flex justify-content-around align-items-center">
    <p-galleria [value]="images" [(activeIndex)]="activeIndex" [(visible)]="displayCustom"
      [responsiveOptions]="responsiveOptions" [containerStyle]="{'max-width': '850px'}" [numVisible]="7"
      [circular]="true" [fullScreen]="false" [showItemNavigators]="false" [showThumbnails]="false"
      [baseZIndex]="100000">
      <ng-template pTemplate="item" let-item>

        <!-- TODO: Show only 4-5 images, the rest of the images can be seen from withing full screen carousel -->
        <div *ngIf="images" class="flex flex-column mx-5" style="max-width: 150px;max-height: 100%;">
          <div *ngFor="let image of images; let index = index;" class="col-3" key="index">
            <img [src]="image" width="120px" height="120px" [alt]="image" style="cursor: pointer"
              (click)="imageClick(index)" />
          </div>
        </div>
        <p-image [src]="item" [preview]="true" width="400px" height="400px" />
      </ng-template>
    </p-galleria>
    <div *ngIf="product"
      class="relative border-300 border-1 border-round-xl surface-overlay m-5 flex flex-column align-items-center justify-content-around"
      style="min-width: 500px; min-height: 500px">
      <p-tag class="m-1 tag" severity="danger" value="Excellent price" [rounded]="true"></p-tag>
      <i class="pi pi-heart favorite"></i>
      <div class="align-self-start m-2 mt-5 px-2 flex flex-column">
        <h2 class="font-bold">
          {{product?.name}}
        </h2>
        <span class="font-light">
          EAN: {{product.EAN}}
        </span>
        <span class="font-light align-self-start">
          {{product?.category?.name}} > {{product?.subcategory?.name}}
        </span>
      </div>
      <span class="align-self-start mx-2 px-2">
        {{product.description}}
      </span>
      <span *ngIf="product.inStock > 0; else notAvailable"
        class="align-self-start font-medium text-green-400 mx-2 px-2">Available</span>
      <ng-template #notAvailable>
        <span class="align-self-start font-medium text-red-400 mx-2 px-2">Unavailable at the
          moment</span>
      </ng-template>
      <div class="flex align-self-start flex-column">
        <span class="product-price px-2 mx-2">
          {{product.price}} RSD
        </span>
        <span class="font-medium align-self-start px-2 mx-2">
          or 12 x {{getInstallmentPayAmount(product.price)}} RSD
        </span>
      </div>
      <button pButton pRipple type="button" label="Buy now" class="p-button-outlined p-button-rounded m-1 p-2"
        style="width: 100%" [disabled]="product.inStock === 0"></button>
    </div>
  </div>
</div>

<ng-template #loading>
  <div class="center" style="padding-top: 30px">
    <i class="pi pi-spin pi-spinner" style="font-size: 2rem"></i>
  </div>
</ng-template>

<!-- Suggested products -->
<p-carousel *ngIf="suggestedProducts" [value]="suggestedProducts" [numVisible]="3" [numScroll]="3" [circular]="false"
  [responsiveOptions]="responsiveOptions">
  <ng-template pTemplate="header">
    <h2>Suggested products from category {{product.category?.name}}</h2>
  </ng-template>
  <ng-template let-product pTemplate="item">
    <div class="flex align-items-center justify-content-center">
      <app-product class="m-2" [name]="product.name" [subcategory]="product.subcategory.name" [id]="product.id"
        [images]="product.images" [inStock]="product.inStock" [price]="product.price"
        [description]="product.description" [EAN]="product.EAN"></app-product>
    </div>
    <!-- <div class="product-item">
      <div class="product-item-content">
        <div class="mb-3" style="min-height: 210px;">
          <img src="{{product.images[0]}}" [alt]="product.name" class="product-image" />
        </div>
        <div>
          <h4 class="mb-1">{{product.name}}</h4>
          <h5 class="mt-0 mb-3">${{product.price}}</h5>
          <span *ngIf="product.inStock > 1">{{product.inStock}} items left</span>
          <span *ngIf="product.inStock === 1">{{product.inStock}} item left</span>
          <div class="car-buttons mt-5">
            <p-button type="button" styleClass="p-button p-button-rounded mr-2" icon="pi pi-search"></p-button>
            <p-button type="button" styleClass="p-button-success p-button-rounded mr-2"
              icon="pi pi-star-fill"></p-button>
            <p-button type="button" styleClass="p-button-help p-button-rounded" icon="pi pi-cog"></p-button>
          </div>
        </div>
      </div>
    </div> -->
  </ng-template>
</p-carousel>